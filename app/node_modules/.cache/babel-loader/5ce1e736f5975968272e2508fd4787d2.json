{"ast":null,"code":"function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport React, { useState } from \"react\";\nimport Cropper from \"react-cropper\";\nimport \"cropperjs/dist/cropper.css\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport clsx from \"clsx\";\nimport { IconButton, Popover, Box, Typography, CircularProgress } from \"@material-ui/core\";\nimport PopupState, { bindTrigger, bindPopover } from \"material-ui-popup-state\";\nimport EditIcon from \"@material-ui/icons/Edit\";\nimport SaveIcon from \"@material-ui/icons/Save\";\nimport ExploreIcon from \"@material-ui/icons/Folder\";\nimport CancelIcon from \"@material-ui/icons/Block\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport { uplaodAvatar, removeAvatar } from \"../../data/requests/repo\";\nimport { Button } from \"@esko/cloud-ui-components\";\nvar defaultSrc = \"\";\nvar useStyles = makeStyles({\n  avatarEditorMainbody: {\n    position: \"absolute\",\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    top: 0,\n    left: 0,\n    right: 0,\n    height: 160\n  },\n  avatarEditorMainbodyInUse: {\n    zIndex: 10,\n    background: \"#000\"\n  },\n  avatarEditorMainbodyUloading: {\n    zIndex: 10,\n    background: \"transparent\"\n  },\n  avatarEditor: {\n    overflow: \"hidden\",\n    position: \"relative\",\n    width: 80,\n    height: 80,\n    marginTop: -28,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    borderRadius: \"50%\",\n    \"&:hover\": {\n      backgroundColor: \"rgba(0,0,0,0.7)\"\n    },\n    \"&:hover $fileInputButton\": {\n      display: \"block\"\n    }\n  },\n  fileInputButton: {\n    overflow: \"hidden\",\n    display: \"none\"\n  },\n  hiddenFileInput: {\n    opacity: 0,\n    position: \"absolute\",\n    top: 0,\n    right: 0,\n    bottom: 0,\n    cursor: \"pointer\"\n  },\n  cropper: {\n    position: \"absolute\",\n    top: 0,\n    width: \"100%\"\n  },\n  toolBar: {\n    position: \"absolute\",\n    right: 0,\n    bottom: 0,\n    padding: 2,\n    backgroundColor: \"rgba(0,0,0,0.4)\"\n  },\n  fileInputTool: {\n    overflow: \"hidden\",\n    width: 20,\n    height: 20,\n    position: \"relative\"\n  },\n  cropTool: {\n    display: \"block\"\n  },\n  avatarSpiner: {\n    position: \"absolute\",\n    top: 58,\n    width: \"100%\",\n    display: \"flex\",\n    justifyContent: \"center\"\n  }\n});\nexport var AvatarEditor = function AvatarEditor(_ref) {\n  var _clsx;\n\n  var userNodePath = _ref.userNodePath,\n      _ref$onAvatarChange = _ref.onAvatarChange,\n      onAvatarChange = _ref$onAvatarChange === void 0 ? function (res) {\n    return console.log(res);\n  } : _ref$onAvatarChange,\n      _ref$avatarExists = _ref.avatarExists,\n      avatarExists = _ref$avatarExists === void 0 ? false : _ref$avatarExists,\n      _ref$onError = _ref.onError,\n      onError = _ref$onError === void 0 ? function (err) {\n    return console.log(err);\n  } : _ref$onError;\n\n  var _useState = useState(defaultSrc),\n      _useState2 = _slicedToArray(_useState, 2),\n      image = _useState2[0],\n      setImage = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isUploading = _useState4[0],\n      setUploading = _useState4[1];\n\n  var _useState5 = useState(\"#\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      cropData = _useState6[0],\n      setCropData = _useState6[1];\n\n  var _useState7 = useState(),\n      _useState8 = _slicedToArray(_useState7, 2),\n      cropper = _useState8[0],\n      setCropper = _useState8[1];\n\n  var classes = useStyles();\n\n  var onChange = function onChange(e) {\n    e.preventDefault();\n    var files;\n\n    if (e.dataTransfer) {\n      files = e.dataTransfer.files;\n    } else if (e.target) {\n      files = e.target.files;\n    }\n\n    var reader = new FileReader();\n\n    reader.onload = function () {\n      setImage(reader.result);\n    };\n\n    reader.readAsDataURL(files[0]);\n  };\n\n  var getCropData = function getCropData() {\n    if (typeof cropper !== \"undefined\") {\n      setCropData(cropper.getCroppedCanvas().toDataURL());\n    }\n  };\n\n  var saveAvatar = function saveAvatar() {\n    setImage(\"\");\n    setUploading(true);\n    cropper.getCroppedCanvas().toBlob(function (blob) {\n      uplaodAvatar(userNodePath, blob, executeOnAvatarChange, onError);\n    }, \"binary\");\n  };\n\n  var executeOnAvatarChange = function executeOnAvatarChange() {\n    setUploading(false);\n    onAvatarChange();\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: clsx(classes.avatarEditorMainbody, (_clsx = {}, _defineProperty(_clsx, classes.avatarEditorMainbodyInUse, !!image), _defineProperty(_clsx, classes.avatarEditorMainbodyUloading, !!isUploading), _clsx))\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.avatarEditor\n  }, /*#__PURE__*/React.createElement(\"span\", null, /*#__PURE__*/React.createElement(IconButton, {\n    size: \"small\",\n    className: clsx(classes.fileInputButton)\n  }, /*#__PURE__*/React.createElement(EditIcon, {\n    fontSize: \"small\"\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    className: classes.hiddenFileInput,\n    type: \"file\",\n    title: \"Chose a new file\",\n    onChange: onChange,\n    accept: \"image/*\"\n  }))), !image && avatarExists && /*#__PURE__*/React.createElement(PopupState, {\n    variant: \"popover\",\n    popupId: \"remove-avatar-popover\"\n  }, function (popupState) {\n    return /*#__PURE__*/React.createElement(\"span\", null, /*#__PURE__*/React.createElement(IconButton, Object.assign({\n      size: \"small\",\n      title: \"Delete Avatar\",\n      className: clsx(classes.fileInputButton)\n    }, bindTrigger(popupState)), /*#__PURE__*/React.createElement(DeleteIcon, {\n      fontSize: \"small\"\n    })), /*#__PURE__*/React.createElement(Popover, Object.assign({}, bindPopover(popupState), {\n      anchorOrigin: {\n        vertical: \"bottom\",\n        horizontal: \"center\"\n      },\n      transformOrigin: {\n        vertical: \"top\",\n        horizontal: \"center\"\n      }\n    }), /*#__PURE__*/React.createElement(Box, {\n      p: 2,\n      style: {\n        textAlign: \"center\"\n      }\n    }, /*#__PURE__*/React.createElement(Typography, {\n      paragraph: true\n    }, \"Remove Profile Picture?\"), /*#__PURE__*/React.createElement(Button, {\n      color: \"secondary\",\n      onClick: function onClick() {\n        removeAvatar(userNodePath, onAvatarChange, onError);\n        popupState.close();\n      }\n    }, \"Yes\"), \" \", /*#__PURE__*/React.createElement(Button, {\n      color: \"secondary\",\n      onClick: popupState.close\n    }, \" \", \"No\", \" \"))));\n  })), !!image && /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.cropper\n  }, /*#__PURE__*/React.createElement(Cropper, {\n    style: {\n      height: 160,\n      width: \"100%\"\n    },\n    zoomTo: 1,\n    preview: \".img-preview\",\n    src: image,\n    viewMode: 1,\n    dragMode: \"move\",\n    guides: true,\n    minCropBoxHeight: 10,\n    minCropBoxWidth: 10,\n    background: false,\n    responsive: false,\n    autoCropArea: 1,\n    aspectRatio: 1,\n    scalable: false,\n    cropBoxResizable: false,\n    cropBoxMovable: false,\n    checkOrientation: false,\n    onInitialized: function onInitialized(instance) {\n      setCropper(instance);\n    }\n  })), !!image && /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.toolBar\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    size: \"small\",\n    title: \"Cancel\",\n    className: classes.cropTool,\n    onClick: function onClick() {\n      return setImage(\"\");\n    }\n  }, /*#__PURE__*/React.createElement(CancelIcon, {\n    fontSize: \"small\"\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.fileInputTool\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    size: \"small\"\n  }, /*#__PURE__*/React.createElement(ExploreIcon, {\n    fontSize: \"small\"\n  })), /*#__PURE__*/React.createElement(\"input\", {\n    className: classes.hiddenFileInput,\n    type: \"file\",\n    title: \"Chose a new file\",\n    onChange: onChange,\n    accept: \"image/*\"\n  })), /*#__PURE__*/React.createElement(IconButton, {\n    size: \"small\",\n    title: \"Save\",\n    className: classes.cropTool,\n    onClick: saveAvatar\n  }, /*#__PURE__*/React.createElement(SaveIcon, {\n    fontSize: \"small\"\n  }))), !!isUploading && /*#__PURE__*/React.createElement(\"span\", {\n    className: classes.avatarSpiner\n  }, /*#__PURE__*/React.createElement(CircularProgress, {\n    size: 20,\n    thickness: 5\n  })));\n};\nexport default AvatarEditor;","map":{"version":3,"sources":["../../../../src/components/AvatarEditor/index.js"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import React, { useState } from \"react\";\nimport Cropper from \"react-cropper\";\nimport \"cropperjs/dist/cropper.css\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport clsx from \"clsx\";\nimport { IconButton, Popover, Box, Typography, CircularProgress } from \"@material-ui/core\";\nimport PopupState, { bindTrigger, bindPopover } from \"material-ui-popup-state\";\nimport EditIcon from \"@material-ui/icons/Edit\";\nimport SaveIcon from \"@material-ui/icons/Save\";\nimport ExploreIcon from \"@material-ui/icons/Folder\";\nimport CancelIcon from \"@material-ui/icons/Block\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport { uplaodAvatar, removeAvatar } from \"../../data/requests/repo\";\nimport { Button } from \"@esko/cloud-ui-components\";\nconst defaultSrc = \"\";\nconst useStyles = makeStyles({\n    avatarEditorMainbody: {\n        position: \"absolute\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        top: 0,\n        left: 0,\n        right: 0,\n        height: 160\n    },\n    avatarEditorMainbodyInUse: {\n        zIndex: 10,\n        background: \"#000\"\n    },\n    avatarEditorMainbodyUloading: {\n        zIndex: 10,\n        background: \"transparent\"\n    },\n    avatarEditor: {\n        overflow: \"hidden\",\n        position: \"relative\",\n        width: 80,\n        height: 80,\n        marginTop: -28,\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        borderRadius: \"50%\",\n        \"&:hover\": {\n            backgroundColor: \"rgba(0,0,0,0.7)\"\n        },\n        \"&:hover $fileInputButton\": {\n            display: \"block\"\n        }\n    },\n    fileInputButton: {\n        overflow: \"hidden\",\n        display: \"none\"\n    },\n    hiddenFileInput: {\n        opacity: 0,\n        position: \"absolute\",\n        top: 0,\n        right: 0,\n        bottom: 0,\n        cursor: \"pointer\"\n    },\n    cropper: {\n        position: \"absolute\",\n        top: 0,\n        width: \"100%\"\n    },\n    toolBar: {\n        position: \"absolute\",\n        right: 0,\n        bottom: 0,\n        padding: 2,\n        backgroundColor: \"rgba(0,0,0,0.4)\"\n    },\n    fileInputTool: {\n        overflow: \"hidden\",\n        width: 20,\n        height: 20,\n        position: \"relative\"\n    },\n    cropTool: {\n        display: \"block\"\n    },\n    avatarSpiner: {\n        position: \"absolute\",\n        top: 58,\n        width: \"100%\",\n        display: \"flex\",\n        justifyContent: \"center\"\n    }\n});\nexport const AvatarEditor = ({ userNodePath, onAvatarChange = res => console.log(res), avatarExists = false, onError = err => console.log(err) }) => {\n    const [image, setImage] = useState(defaultSrc);\n    const [isUploading, setUploading] = useState(false);\n    const [cropData, setCropData] = useState(\"#\");\n    const [cropper, setCropper] = useState();\n    const classes = useStyles();\n    const onChange = e => {\n        e.preventDefault();\n        let files;\n        if (e.dataTransfer) {\n            files = e.dataTransfer.files;\n        }\n        else if (e.target) {\n            files = e.target.files;\n        }\n        const reader = new FileReader();\n        reader.onload = () => {\n            setImage(reader.result);\n        };\n        reader.readAsDataURL(files[0]);\n    };\n    const getCropData = () => {\n        if (typeof cropper !== \"undefined\") {\n            setCropData(cropper.getCroppedCanvas().toDataURL());\n        }\n    };\n    const saveAvatar = () => {\n        setImage(\"\");\n        setUploading(true);\n        cropper.getCroppedCanvas().toBlob(blob => {\n            uplaodAvatar(userNodePath, blob, executeOnAvatarChange, onError);\n        }, \"binary\");\n    };\n    const executeOnAvatarChange = () => {\n        setUploading(false);\n        onAvatarChange();\n    };\n    return (React.createElement(\"div\", { className: clsx(classes.avatarEditorMainbody, {\n            [classes.avatarEditorMainbodyInUse]: !!image,\n            [classes.avatarEditorMainbodyUloading]: !!isUploading\n        }) },\n        React.createElement(\"div\", { className: classes.avatarEditor },\n            React.createElement(\"span\", null,\n                React.createElement(IconButton, { size: \"small\", className: clsx(classes.fileInputButton) },\n                    React.createElement(EditIcon, { fontSize: \"small\" }),\n                    React.createElement(\"input\", { className: classes.hiddenFileInput, type: \"file\", title: \"Chose a new file\", onChange: onChange, accept: \"image/*\" }))),\n            !image && avatarExists && (React.createElement(PopupState, { variant: \"popover\", popupId: \"remove-avatar-popover\" }, popupState => (React.createElement(\"span\", null,\n                React.createElement(IconButton, Object.assign({ size: \"small\", title: \"Delete Avatar\", className: clsx(classes.fileInputButton) }, bindTrigger(popupState)),\n                    React.createElement(DeleteIcon, { fontSize: \"small\" })),\n                React.createElement(Popover, Object.assign({}, bindPopover(popupState), { anchorOrigin: {\n                        vertical: \"bottom\",\n                        horizontal: \"center\"\n                    }, transformOrigin: {\n                        vertical: \"top\",\n                        horizontal: \"center\"\n                    } }),\n                    React.createElement(Box, { p: 2, style: { textAlign: \"center\" } },\n                        React.createElement(Typography, { paragraph: true }, \"Remove Profile Picture?\"),\n                        React.createElement(Button, { color: \"secondary\", onClick: () => {\n                                removeAvatar(userNodePath, onAvatarChange, onError);\n                                popupState.close();\n                            } }, \"Yes\"),\n                        \" \",\n                        React.createElement(Button, { color: \"secondary\", onClick: popupState.close },\n                            \" \",\n                            \"No\",\n                            \" \")))))))),\n        !!image && (React.createElement(\"div\", { className: classes.cropper },\n            React.createElement(Cropper, { style: { height: 160, width: \"100%\" }, zoomTo: 1, preview: \".img-preview\", src: image, viewMode: 1, dragMode: \"move\", guides: true, minCropBoxHeight: 10, minCropBoxWidth: 10, background: false, responsive: false, autoCropArea: 1, aspectRatio: 1, scalable: false, cropBoxResizable: false, cropBoxMovable: false, checkOrientation: false, onInitialized: instance => {\n                    setCropper(instance);\n                } }))),\n        !!image && (React.createElement(\"div\", { className: classes.toolBar },\n            React.createElement(IconButton, { size: \"small\", title: \"Cancel\", className: classes.cropTool, onClick: () => setImage(\"\") },\n                React.createElement(CancelIcon, { fontSize: \"small\" })),\n            React.createElement(\"div\", { className: classes.fileInputTool },\n                React.createElement(IconButton, { size: \"small\" },\n                    React.createElement(ExploreIcon, { fontSize: \"small\" })),\n                React.createElement(\"input\", { className: classes.hiddenFileInput, type: \"file\", title: \"Chose a new file\", onChange: onChange, accept: \"image/*\" })),\n            React.createElement(IconButton, { size: \"small\", title: \"Save\", className: classes.cropTool, onClick: saveAvatar },\n                React.createElement(SaveIcon, { fontSize: \"small\" })))),\n        !!isUploading && (React.createElement(\"span\", { className: classes.avatarSpiner },\n            React.createElement(CircularProgress, { size: 20, thickness: 5 })))));\n};\nexport default AvatarEditor;\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"module"}