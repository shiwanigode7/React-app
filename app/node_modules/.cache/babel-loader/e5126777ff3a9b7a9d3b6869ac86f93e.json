{"ast":null,"code":"function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport React, { createContext, useState, useEffect } from \"react\";\nimport { getUserInfo } from \"./requests/iam\";\nimport { getCurrentAppVersion } from \"./requests/version\";\nimport appsMetadata from \"./appsMetadata\";\nvar ComponentsDataContext = /*#__PURE__*/createContext(null);\nvar currentApp = window.location.host.split(\".\").splice(0, 1).join(\"\");\nvar defaultApp = \"esko\";\n\nvar ComponentsDataProvider = function ComponentsDataProvider(_ref) {\n  var _ref$config = _ref.config,\n      config = _ref$config === void 0 ? {} : _ref$config,\n      children = _ref.children;\n\n  var getUserInfoAndSetIt = function getUserInfoAndSetIt() {\n    getUserInfo(config).then(function (info) {\n      setData(function (currData) {\n        return Object.assign(Object.assign({}, currData), {\n          isFetching: false,\n          users: {\n            current: Object.assign({}, info)\n          }\n        });\n      });\n    }, function (err) {\n      setData(function (currData) {\n        return Object.assign(Object.assign({}, currData), {\n          error: err\n        });\n      });\n    });\n  };\n\n  var componentsDataDefaultValue = Object.assign({\n    isFetching: true,\n    error: false,\n    users: {\n      current: {}\n    },\n    apps: Object.assign(Object.assign({}, appsMetadata), {\n      current: appsMetadata[currentApp] || appsMetadata[defaultApp]\n    }),\n    methods: {\n      getCurrentUser: getUserInfoAndSetIt\n    }\n  }, config);\n\n  var _useState = useState(componentsDataDefaultValue),\n      _useState2 = _slicedToArray(_useState, 2),\n      data = _useState2[0],\n      setData = _useState2[1]; //this needs to change for a proper state store\n\n\n  var getVersion = function getVersion() {\n    var _a;\n\n    var lang = ((_a = data.users.current) === null || _a === void 0 ? void 0 : _a.userLanguage) || navigator.language;\n    getCurrentAppVersion(lang).then(function (data) {\n      setData(function (currData) {\n        return Object.assign(Object.assign({}, currData), {\n          revision: data\n        });\n      });\n    }, function (err) {\n      setData(function (currData) {\n        return Object.assign(Object.assign({}, currData), {\n          error: err\n        });\n      });\n    });\n  };\n\n  useEffect(function () {\n    if (config && Object.keys(config).length) {\n      setData(function (currData) {\n        return Object.assign(Object.assign({}, currData), config);\n      });\n    }\n  }, [config]);\n  useEffect(function () {\n    getUserInfoAndSetIt();\n  }, [data.organization]); //this will later convert on get apps metadata\n\n  useEffect(function () {\n    getVersion();\n  }, [data.users.current]);\n  return /*#__PURE__*/React.createElement(ComponentsDataContext.Provider, {\n    value: data\n  }, children);\n};\n\nexport { ComponentsDataContext, ComponentsDataProvider };","map":{"version":3,"sources":["../../../src/data/componentsContext.js"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import React, { createContext, useState, useEffect } from \"react\";\nimport { getUserInfo } from \"./requests/iam\";\nimport { getCurrentAppVersion } from \"./requests/version\";\nimport appsMetadata from \"./appsMetadata\";\nconst ComponentsDataContext = createContext(null);\nconst currentApp = window.location.host\n    .split(\".\")\n    .splice(0, 1)\n    .join(\"\");\nconst defaultApp = \"esko\";\nconst ComponentsDataProvider = ({ config = {}, children }) => {\n    const getUserInfoAndSetIt = () => {\n        getUserInfo(config).then(info => {\n            setData(currData => (Object.assign(Object.assign({}, currData), { isFetching: false, users: {\n                    current: Object.assign({}, info)\n                } })));\n        }, err => {\n            setData(currData => (Object.assign(Object.assign({}, currData), { error: err })));\n        });\n    };\n    const componentsDataDefaultValue = Object.assign({ isFetching: true, error: false, users: {\n            current: {}\n        }, apps: Object.assign(Object.assign({}, appsMetadata), { current: appsMetadata[currentApp] || appsMetadata[defaultApp] }), methods: {\n            getCurrentUser: getUserInfoAndSetIt\n        } }, config);\n    const [data, setData] = useState(componentsDataDefaultValue);\n    //this needs to change for a proper state store\n    const getVersion = () => {\n        var _a;\n        const lang = ((_a = data.users.current) === null || _a === void 0 ? void 0 : _a.userLanguage) || navigator.language;\n        getCurrentAppVersion(lang).then(data => {\n            setData(currData => (Object.assign(Object.assign({}, currData), { revision: data })));\n        }, err => {\n            setData(currData => (Object.assign(Object.assign({}, currData), { error: err })));\n        });\n    };\n    useEffect(() => {\n        if (config && Object.keys(config).length) {\n            setData(currData => (Object.assign(Object.assign({}, currData), config)));\n        }\n    }, [config]);\n    useEffect(() => {\n        getUserInfoAndSetIt();\n    }, [data.organization]);\n    //this will later convert on get apps metadata\n    useEffect(() => {\n        getVersion();\n    }, [data.users.current]);\n    return React.createElement(ComponentsDataContext.Provider, { value: data }, children);\n};\nexport { ComponentsDataContext, ComponentsDataProvider };\n//# sourceMappingURL=componentsContext.js.map"]},"metadata":{},"sourceType":"module"}